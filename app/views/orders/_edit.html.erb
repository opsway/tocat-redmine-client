<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
  jQuery.noConflict()(document).ready(function () {
    jQuery.noConflict()( "#datepicker" ).datepicker({dateFormat: "yy-mm-dd"});
  });
</script>
<%if @order.new_record?
    url = orders_path
  else
    url = order_path(@order.id)
  end %>
<% if params[:order].nil?
    name = @order.name
    des = @order.description
    team = @order.get_team.id
    i_budget = @order.invoiced_budget
    a_budget = @order.allocatable_budget
  else
    name = params[:order][:name]
    des = params[:order][:description]
    team = params[:order][:team]
    i_budget = params[:order][:invoiced_budget]
    a_budget = params[:order][:allocatable_budget]

  end
 %>
<%= labelled_form_for @order, url: url, :html => {:id => 'order-form', :multipart => true} do |f| %>
    <%= error_messages_for @order if @order.present?%>
    <div class="box">
      <fieldset class="tabular"><legend><%= l(:label_change_properties) %></legend>
      <div id="all_attributes">
        <%= labelled_fields_for :order, @order do |f| %>
          <p><%= f.text_field :name, :size => 80, :maxlength => 255, :required => true, :value => name %></p>

          <p>
            <%= f.label_for_field :description %>
            <%= f.text_area :description,
                            :cols => 60,
                            :rows => 10,
                            :accesskey => accesskey(:edit),
                            :class => 'wiki-edit',
                            :no_label => true,
                            :value => des %>
          </p>
          <% if User.current.tocat_allowed_to?(:update_commission) %>
              <p>
                <%= f.number_field :commission, required: true, in: 0..100, :step => 1 %>
              </p>
          <% end %>
          <% unless @order.order_internal? %>
            <p><%= f.number_field :zohobooks_project_id, :required => true %></p>
            <p><%= f.text_field :accrual_completed_date, id: "datepicker", :required => true %></p>
          <% end %>
          <p>
            <%= f.select :team, options_for_select([['Select Team', 0]] + @groups.collect {|t| [t.name, t.id]}, selected: team.blank? ? 0 : team, disabled: 0),
                                { :required => true }, { 'data-commissions' => @groups_commissions.to_json } %>
          </p>
          <p><%= f.number_field :invoiced_budget, :class => 'invoiced_budget', :step => 0.01, :required => true, :value => i_budget %></p>
          <p><%= f.number_field :allocatable_budget, :class => 'allocatable_budget', :step => 0.01, :required => true, :value => a_budget %></p>
        <% end %>
      </div>
      </fieldset>
    </div>
    <%= submit_tag l(:button_submit) %>
    | <%= link_to l(:button_cancel), {}, :onclick => "jQuery.noConflict()('#update').hide(); return false;" %>
<% end %>
